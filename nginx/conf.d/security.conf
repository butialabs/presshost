# WordPress security configurations
# Only additions not in shinsenter/php base

# WordPress specific security headers
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;

# Deny access to wp-config.php
location ~* /wp-config\.php {
    deny all;
}

# Block xmlrpc.php (prevent brute force and DDoS)
location = /xmlrpc.php {
    deny all;
    access_log off;
    log_not_found off;
}

# Block access to WordPress readme and license files
location ~* ^/?(readme|license)\.(txt|html)$ {
    deny all;
}

# Block access to WordPress debug log
location ~* /wp-content/debug\.log$ {
    deny all;
}

# Block PHP execution in uploads directory
location ~* /wp-content/uploads/.*\.php$ {
    deny all;
}

# Block access to wp-config backups
location ~* wp-config.*\.(php|txt|bak)$ {
    deny all;
}